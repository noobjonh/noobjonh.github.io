var a1 = 'Israel Baline had a difficult childhood. His family had to leave Russia when he was very young. They had been discriminated against because they were Jewish. They decided to immigrate to America. When Israel and his family came to New York City, they arrived at Ellis Island. Israel\'s life was not easy.'
var b1 = 'His family was poor. When he was young, he worked very hard delivering newspapers to help his family. When Israel grew up, he decided to do what he liked best. He was a singer. He changed his name to Irving Berlin. He sang in small cafes in New York. Then, he became very popular. Irving not only sang, he also wrote songs. His music was played all over the world.'
var c1 = 'His songs were so admired that he was invited to visit the President of the U.S. He also created musical plays. They were performed on Broadway, where New York\'s most famous theaters are located. Irving became wealthy, but he was never greedy. He composed "God Bless America," a very well known song. He donated the money he earned from it to the Girl Scouts and Boy Scouts. Another song he wrote is "White Christmas." You may have heard it playing in December. These songs helped Americans during World War II. They gave people hope for victory. Irving deeply loved America. He also loved New York City. He lived and worked there his whole life. It was a long life, too. He lived to be 101 years old! We can be proud of Irving. His life shows how important it is to work hard and do what you do best.'
var d1 = 'Over the ensuing days, however, I realized that everyone seemed to be discussing how to build large and successful companies, sell out, and live the good life. Fair enough. The question no one really seemed to be asking or answering was, Why do it all in the first place? What is the pot of gold that justifies spending the best years of your life hoping for happiness in the last? The lectures I ultimately developed, titled "Drug Dealing for Fun and Profit," began with a simple premise: Test the most basic assumptions of the work-life equation.'
var e1 = 'Spring 1999 In three months, I accept and quit jobs as a curriculum designer at Berlitz, the world\'s largest publisher of foreignlanguage materials, and as an analyst at a three-person political asylum research firm. Naturally, I then fly to Taiwan to create a gym chain out of thin air and get shut down by Triads, Chinese mafia. I return to the U.S. defeated and decide to learn kickboxing, winning the national championship four weeks later with the ugliest and most unorthodox style ever witnessed.'
var f1 = 'Filch owned a cat called Mrs. Norris, a scrawny, dust-colored creature with bulging, lamp like eyes just like Filch\'s. She patrolled the corridors alone. Break a rule in front of her, put just one toe out of line, and she\'d whisk off for Filch, who\'d appear, wheezing, two seconds later. Filch knew the secret passageways of the school better than anyone (except perhaps the Weasley twins) and could pop up as suddenly as any of the ghosts. The students all hated him, and it was the dearest ambition of many to give Mrs. Norris a good kick. And then, once you had managed to find them, there were the classes themselves. There was a lot more to magic, as Harry quickly found out, than waving your wand and saying a few funny words.'
var g1 = 'They had to study the night skies through their telescopes every Wednesday at midnight and learn the names of different stars and the movements of the planets. Three times a week they went out to the greenhouses behind the castle to study Herbology, with a dumpy little witch called Professor Sprout, where they learned how to take care of all the strange plants and fungi, and found out what they were used for. Easily the most boring class was History of Magic, which was the only one taught by a ghost. Professor Binns had been very old indeed when he had fallen asleep in front of the staff room fire and got up next morning to teach, leaving his body behind him. Binns droned on and on while they scribbled down names and dates, and got Emetic the Evil and Uric the Oddball mixed up.'
var h1 = '"I think she heard you." "So?" said Ron, but he looked a bit uncomfortable. "She must\'ve noticed she\'s got no friends." Hermione didn\'t turn up for the next class and wasn\'t seen all afternoon. On their way down to the Great Hall for the Halloween feast, Harry and Ron overheard Parvati Patil telling her friend Lavender that Hermione was crying in the girls\' bathroom and wanted to be left alone. Ron looked still more awkward at this, but a moment later they had entered the Great Hall, where the Halloween decorations put Hermione out of their minds.'
var i1 = '"Dunno what Harry thinks he\'s doing," Hagrid mumbled. He stared through his binoculars. "If I didn\' know better, I\'d say he\'d lost control of his broom. . . but he can\'t have. . ." Suddenly, people were pointing up at Harry all over the stands. His broom had started to roll over and over, with him only just managing to hold on. Then the whole crowd gasped. Harry\'s broom had given a wild jerk and Harry swung off it. He was now dangling from it, holding on with only one hand.'
var j1 = '"Dunno what Harry thinks he\'s doing," Hagrid mumbled. He stared through his binoculars. "If I didn\' know better, I\'d say he\'d lost control of his broom. . . but he can\'t have. . ." Suddenly, people were pointing up at Harry all over the stands. His broom had started to roll over and over, with him only just managing to hold on. Then the whole crowd gasped. Harry\'s broom had given a wild jerk and Harry swung off it. He was now dangling from it, holding on with only one hand.'
var k1 = '"Dunno what Harry thinks he\'s doing," Hagrid mumbled. He stared through his binoculars. "If I didn\' know better, I\'d say he\'d lost control of his broom. . . but he can\'t have. . ." Suddenly, people were pointing up at Harry all over the stands. His broom had started to roll over and over, with him only just managing to hold on. Then the whole crowd gasped. Harry\'s broom had given a wild jerk and Harry swung off it. He was now dangling from it, holding on with only one hand. "Oh, she has turned all the men\'s heads down in that part. She is the daintiest thing under a bonnet on this planet. So say the Serpentine-mews, to a man. She lives quietly, sings at concerts, drives out at five every day, and returns at seven sharp for dinner. Seldom goes out at other times, except when she sings. Has only one male visitor, but a good deal of him. He is dark, handsome, and dashing, never calls less than once a day, and often twice. He is a Mr. Godfrey Norton, of the Inner Temple. See the advantages of a cabman as a confidant. They had driven him home a dozen times from Serpentine-mews, and knew all about him.'
var l1 = 'When I had listened to all they had to tell, I began to walk up and down near Briony Lodge once more, and to think over my plan of campaign. "This Godfrey Norton was evidently an important factor in the matter. He was a lawyer. That sounded ominous. What was the relation between them, and what the object of his repeated visits? Was she his client, his friend, or his mistress? If the former, she had probably transferred the photograph to his keeping. If the latter, it was less likely. On the issue of this question depended whether I should continue my work at Briony Lodge, or turn my attention to the gentleman\'s chambers in the Temple. It was a delicate point, and it widened the field of my inquiry. I fear that I bore you with these details, but I have to let you see my little difficulties, if you are to understand the situation." '
var m1 = '"This was quite too good to lose, Watson. I was just balancing whether I should run for it, or whether I should perch behind her landau when a cab came through the street. The driver looked twice at such a shabby fare, but I jumped in before he could object. \'The Church of St. Monica,\' said I, \'and half a sovereign if you reach it in twenty minutes.\' It was twenty-five minutes to twelve, and of course it was clear enough what was in the wind. '
var n1 = '"My cabby drove fast. I don\'t think I ever drove faster, but the others were there before us. The cab and the landau with their steaming horses were in front of the door when I arrived. I paid the man and hurried into the church. There was not a soul there save the two whom I had followed and a surpliced clergyman, who seemed to be expostulating with them. They were all three standing in a knot in front of the altar. I lounged up the side aisle like any other idler who has dropped into a church. Suddenly, to my surprise, the three at the altar faced round to me, and Godfrey Norton came running as hard as he could towards me.'
var o1 = 'Lisa Allen, according to her file, was thirty-four years old, had started smoking and drinking when she was sixteen, and had struggled with obesity for most of her life. At one point, in her mid-twenties, collection agencies were hounding her to recover $10,000 in debts. An old resume listed her longest job as lasting less than a year. The woman in front of the researchers today, however, was lean and vibrant, with the toned legs of a runner. She looked a decade younger than the photos in her chart and like she could out-exercise anyone in the room. According to the most recent report in her file, Lisa had no outstanding debts, didn\'t drink, and was in her thirty-ninth month at a graphic design firm.'
var p1 = '"How long since your last cigarette?" one of the physicians asked, starting down the list of questions Lisa answered every time she came to this laboratory outside Bethesda, Maryland. "Almost four years," she said, "and I\'ve lost sixty pounds and run a marathon since then." She\'d also started a master\'s degree and bought a home. It had been an eventful stretch. The scientists in the room included neurologists, psychologists, geneticists, and a sociologist. For the past three years, with funding from the National Institutes of Health, they had poked and prodded Lisa and more than two dozen other former smokers, chronic overeaters, problem drinkers, obsessive shoppers, and people with other destructive habits. All of the participants had one thing in common: They had remade their lives in relatively short periods of time.'
var q1 = 'Eugene\'s doctors told Beverly there was nothing they could do to counter the damage already done, but a large dose of antiviral drugs might prevent it from spreading. Eugene slipped into a coma and for ten days was close to death. Gradually, as the drugs fought the disease, his fever receded and the virus disappeared. When he finally awoke, he was weak and disoriented and couldn\'t swallow properly. He couldn\'t form sentences and would sometimes gasp, as if he had momentarily forgotten how to breathe.'
var s1 = 'What if you started thinking of your life goals, not as big, audacious things that you can only achieve when the time is right or when you have better resources or when you finally catch your big break . . . but instead as tiny, daily behaviors that are repeated until success becomes inevitable? What if losing 50 pounds wasn\'t dependent on a researcher discovering the perfect diet or you finding a superhuman dose of willpower, but hinged on a series of tiny habits that you could always control? Habits like walking for 20 minutes per day, drinking 8 glasses of water per day, eating two meals instead of three.'
var t1 = 'It often feels difficult to keep good habits going for more than a few days, even with sincere effort and the occasional burst of motivation. Habits like exercise, meditation, journaling, and cooking are reasonable for a day or two and then become a hassle. He would place each cat inside a device known as a puzzle box. The box was designed so that the cat could escape through a door "by some simple act, such as pulling at a loop of cord, pressing a lever, or stepping on a platform." For example, one box contained a lever that, when pressed, would open a door on the side of the box. Once the door had been opened, the cat could dart out and run over to a bowl of food. Most cats wanted to escape as soon as they were placed inside the box. ' 
var u1 = 'They would poke their nose into the corners, stick their paws through openings, and claw at loose objects. After a few minutes of exploration, the cats would happen to press the magical lever, the door would open, and they would escape. Thorndike tracked the behavior of each cat across many trials. In the beginning, the animals moved around the box at random. But as soon as the lever had been pressed and the door opened, the process of learning began. Gradually, each cat learned to associate the action of pressing the lever with the reward of escaping the box and getting to the food. After twenty to thirty trials, this behavior became so automatic and habitual that the cat could escape within a few seconds.'
var v1 = 'They had this machine. They had two machines, really. One of them slid down into your stomach like a black cobra down an echoing well looking for all the old water and the old time gathered there. It drank up the green matter that flowed to the top in a slow boil. Did it drink of the darkness? Did it suck out all the poisons accumulated with the years? It fed in silence with an occasional sound of inner suffocation and blind searching. It had an Eye. '
var w1 = 'The impersonal operator of the machine could, by wearing a special optical helmet, gaze into the soul of the person whom he was pumping out. What did the Eye see? He did not say. He saw but did not see what the Eye saw. The entire operation was not unlike the digging of a trench in one\'s yard. The woman on the bed was no more than a hard stratum of marble they had reached. Go on, anyway, shove the bore down, slush up the emptiness, if such a thing could be brought out in the throb of the suction snake. The operator stood smoking a cigarette. The other machine was working too.'
var y1 = '"But most of all," she said, "I like to watch people. Sometimes I ride the subway all day and look at them and listen to them. I just want to figure out who they are and what they want and where they\'re going. Sometimes I even go to the Fun Parks and ride in the jet cars when they race on the edge of town at midnight and the police don\'t care as long as they\'re insured. As long as everyone has ten thousand insurance everyone\'s happy. Sometimes I sneak around and listen in subways. Or I listen at soda fountains, and do you know what?" "What?" "People don\'t talk about anything." "Oh, they must!" "No, not anything. They name a lot of cars or clothes or swimming-pools mostly and say how swell! '
var z1 = 'But they all say the same things and nobody says anything different from anyone else. And most of the time in the cafes they have the joke-boxes on and the same jokes most of the time, or the musical wall lit and all the colored patterns running up and down, but it\'s only color and all abstract. And at the museums, have you ever been? All abstract. That\'s all there is now. My uncle says it was different once. A long time back sometimes pictures said things or even showed people." "Your uncle said, your uncle said. Your uncle must be a remarkable man." "He is. He certainly is. Well, I\'ve got to be going. Goodbye, Mr. Montag."'
var a2 = '"Whenever you feel like criticizing any one," he told me, "just remember that all the people in this world haven\'t had the advantages that youve had."He didnt say any more, but weve always been unusually communicative in a reserved way, and I understood that he meant a great deal more than that. In consequence, Im inclined to reserve all judgments, a habit that has opened up many curious natures to me and also made me the victim of not a few veteran bores. The abnormal mind is quick to detect and attach itself to this quality when it appears in a normal person, and so it came about that in college I was unjustly accused of being a politician, because I was privy to the secret griefs of wild, unknown men.'
var b2 = 'Most of the confidences were unsought - frequently I have feigned sleep, preoccupation, or a hostile levity when I realized by some unmistakable sign that an intimate revelation was quivering on the horizon; for the intimate revelations of young men, or at least the terms in which they express them, are usually plagiaristic and marred by obvious suppressions. Reserving judgments is a matter of infinite hope. I am still a little afraid of missing something if I forget that, as my father snobbishly suggested, and I snobbishly repeat, a sense of the fundamental decencies is parcelled out unequally at birth. And, after boasting this way of my tolerance, I come to the admission that it has a limit. Conduct may be founded on the hard rock or the wet marshes, but after a certain point I dont care what its founded on.'
var c2 = 'I was still with Jordan Baker. We were sitting at a table with a man of about my age and a rowdy little girl, who gave way upon the slightest provocation to uncontrollable laughter. I was enjoying myself now. I had taken two finger-bowls of champagne, and the scene had changed before my eyes into something significant, elemental, and profound. At a lull in the entertainment the man looked at me and smiled. "Your face is familiar," he said, politely. "Werent you in the Third Division during the war?"'
var d2 = 'The goose took command and began to give orders. "Don\'t just stand there, Wilbur! Dodge about, dodge about!" cried the goose. "Skip around, run toward me, slip in and out, in and out, in and out! Make for the woods! Twist and tum!" The cocker spaniel sprang for Wilbur\'s hind leg. Wilbur jumped and ran. '
var e2 = 'Lurvy reached out and grabbed. Mrs. Zuckerman screamed at Lurvy. Right now I am on my way to your trough to eat your breakfast, since you haven\'t got sense enough to eat it yourself." And Templeton, the rat, crept stealthily along the wall and disappeared into a private tunnel that he had dug between the door and the trough in Wilbur\'s yard. Templeton was a crafty rat, and he had things pretty much his own way. The tunnel was an example of his skill and cunning. The tunnel enabled him to get from the barn to his hiding place under the pig trough without coming out into the open. He had tunnels and runways all over Mr. Zuckerman\'s farm and could get from one place to another without being seen. Usually he slept during the daytime and was abroad only after dark. '
var array = [a1,b1,c1,d1,e1,f1,g1,h1,i1,j1,k1,l1,m1,n1,o1,p1,q1,s1,t1,u1,v1,w1,y1,z1,a2,b2,c2,d2,e2];
array = array.sort(() => (Math.random()>.5)?1:-1)
array = array.toString()



var x = array

var content = document.querySelector('.content')
var input = document.querySelector('.layer1')
var input1 = document.querySelector('.layer2')
var timeDisplay = document.querySelector('#time')
var timeLimit = document.querySelector('.time-pick')
var speedDispaly = document.querySelector('.status2')
var button = document.querySelector('.redo')
var wordAmount = document.querySelector('#words')
var realTypingSpeed = document.querySelector('#speed')
var realAccuracy = document.querySelector('#accuracy')
window.addEventListener('load', function(){
    console.innerHTML = ''
    timeLimit.style.setProperty('--translated','115%')
  } 
)
var blinktimeout
var blinkstyle = "background-color:#9900ff";//blinker's color

const blinkRate = () => {
    var n = input.innerText.length;
    content.innerHTML = '<span class="character">'+ x.substr(0, n) + "</span><span id='blink'style='" + blinkstyle + "'>" + x.substr(n, 1) + "</span>" + x.substr(n + 1);//wrap the partof text(letter) with a span that has the style set to blinkstyle
    //###var id = document.querySelector('#blink').getAttribute('width')
    if (blinkstyle == "background-color:#9900ff") {
      blinkstyle = "background-color:#9900ff00";
    } 
    else if (blinkstyle=='background-color:#9900ff00') {
      blinkstyle = "background-color:#9900ff";
    }
    setTimeout(blinkRate,500)
}

timeLimit.addEventListener('click',blinkRate)
    
const moveAmount = amount => {
  content.style.setProperty('--translate',amount)
}

const moveContent = () => {
    var n = input.innerText.length;
    var n1 = parseInt(n*-1)
    moveAmount(n1)
}

input.addEventListener('input',moveContent)
//------------------------------------------------------------------------------------------------------------------------------------------
  
 function clickc() {
    var caretPos = input.innerText.length;
    var el = input;
    var range = document.createRange();
    var sel = window.getSelection();
    if (el.childNodes[0]) {
      range.setStart(el.childNodes[0], caretPos);
      range.collapse(true);
      sel.removeAllRanges();
      sel.addRange(range);
    }
  }
input.addEventListener('mouseup',clickc)
input.addEventListener('keyup',clickc)



//--------------------------------------------------------------------------------------------------------------------------------------

const compare = () => {
  var txt = ''
  for (i = 0; i < input.innerText.length; i++) {
    if (x[i] == input.innerText[i] || (x[i].charCodeAt(0) == 32 && input.innerText[i].charCodeAt(0) == 160)) {
      txt += "<span class='correctCharacter'>" + input.innerText[i] + "</span>";
    }//wraps the correct characters in the good span 
    else {
      txt += "<span class='errorCharacter'>" + input.innerText[i] + "</span>";
    }//wraps the incorrect characters in the bad span    
  }
  input1.innerHTML = txt;
}
input.addEventListener('input',compare)


const accuracyCheck = () => {
  var correct = 0
  var wrong = 0 
  for (i = 0; i < input.innerText.length; i++) {
    if (x[i] == input.innerText[i] || (x[i].charCodeAt(0) == 32 && input.innerText[i].charCodeAt(0) == 160)) {
     correct+=1
    }//wraps the correct characters in the good span 
    else {
      wrong+=1;
    }//wraps the incorrect characters in the bad span    
  }
  var accuracy = (correct/(correct+wrong))
 return accuracy 
}

//input.addEventListener('input',accuracyCheck)

//time picker --------------------------------------------------------------------------------------------------------------------------------
var min1 = document.querySelector('.time1')
var min2 = document.querySelector('.time2')
var min3 = document.querySelector('.time3')
var min5 = document.querySelector('.time5')
var min10 = document.querySelector('.time10')
var rmin = 0
var min

function setTimer(val){
  tiem = val
  timeDisplay.innerText = tiem+' minutes'
   timeLimit.style.setProperty('--translated','300%')

   input.contentEditable = true
   input.focus()
   timeLimit.style.height = '100%'
}
min1.addEventListener('click',function(){
  setTimer(1) 
  rmin += 1
  min = rmin-1
})
min2.addEventListener('click',function(){
  setTimer(2)
  rmin += 2
  min = rmin-1
})
min3.addEventListener('click',function(){
  setTimer(3)
  rmin += 3
  min = rmin-1
})
min5.addEventListener('click',function(){
  setTimer(5)
  rmin += 5
  min = rmin-1
})
min10.addEventListener('click',function(){
  setTimer(10)
  rmin += 10
  min = rmin-1
})


//timer----------------------------------------------------------------------------------------------------------------------------------------

//var rmin = 0

var rsec = 60
var sec = rsec
const countDown = () => {

  if(min>-1){
    if(sec>=0){
      sec--
    }
    if(sec<0){
      sec =rsec-1
      min--
    }

    var time =parseInt(`${min}${sec}`)
    if(time>0){
      if(sec>=10){
        timeDisplay.innerText = `${min} :: ${sec}`
      }
      if(sec<10){
        timeDisplay.innerText = `${min} :: 0${sec}`
      }
    }
    if(time==0){
      timeDisplay.innerText = `${0} :: 0${0}`
      input.contentEditable = false
      speedDispaly.style.setProperty('--translating','115%')
      blinkstyle = ''
      button.style.pointerEvents = 'visible'
      realTypingSpeed.innerText = typingSpeedA() 
      realAccuracy.innerText = Math.floor(accuracyCheck()*100)+'%'
    }
  }
  setTimeout(countDown,1000)
}

function addEventListenerOnce(target, type, listener, addOptions, removeOptions) {
  target.addEventListener(type, function fn(event) {
      target.removeEventListener(type, fn, removeOptions);
      listener.apply(this, arguments);
  }, addOptions);
}

addEventListenerOnce(input,'input',countDown)
//input.addEventListener('input',countDown,{once:true})

//word count-----------------------------------------------------------------------------------------------------------------------------------
function countWords(strng) {
  var strng2 = strng.replace(/&nbsp;/g,'')//remove all extra spaces
  var trm1 = strng2.trim()//remove whitenoise
  var strng1 = trm1.replace(/,/g,'')//remove commas
  var splt = strng1.split(' ')//turn into array
  var srt = splt.sort()//arrange in ascending order
  var str = srt.toString()//turn it back to a string
  var rep = str.replace(/,/g,' ')//remove the formed commas
  var trm = rep.trim()//remove whitenoise
  var splt2 = trm.split(' ')//turn into array 
  //get number of items in array
  return splt2.length
}
 
function wordsDisplayer(){
  var words = countWords(input.textContent)
  wordAmount.innerText = words+' words'
}
input.addEventListener('input',wordsDisplayer)

//speed count without accuracy ----------------------------------------------------------------------------------------------------------------
function typingSpeed(){
  var typspd = countWords(input.textContent)/rmin
  return typspd
}

//accurate speed ----------------------------------------------------------------------------------------------------------------------
function typingSpeedA(){
  var realSpeed = typingSpeed()*accuracyCheck()
  return Math.floor(realSpeed)
}

// paragraph----------------------------------------------------------------------------------

